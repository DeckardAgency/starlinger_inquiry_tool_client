<!-- draft-order-table.component.html -->
<div class="order-table-container">
  <div class="table-wrapper">
    <table class="order-table">
      <thead>
      <tr>
        <th (click)="sortByDate()" class="sortable">
          Date Created
          <span class="sort-icon" [ngClass]="getSortIconClass()"></span>
        </th>
        <th>Type</th>
        <th>Internal reference number</th>
        <th>Customer</th>
        <th>Status</th>
        <th></th> <!-- Column for more options -->
      </tr>
      </thead>
      <tbody>
      <ng-container *ngIf="!loading; else loadingTemplate">
        <tr *ngFor="let item of items; trackBy: trackByFn" (click)="stopPropagation($event)">
          <td>{{ item.dateCreated }}</td>
          <td>
            <span class="badge" [ngClass]="getTypeClass(item.type)">{{ item.type }}</span>
          </td>
          <td>{{ item.referenceNumber || '–' }}</td>
          <td class="customer-cell">
            <div class="customer-container">
              <div class="avatar" *ngIf="!item.customer.avatar">
                {{ item.customer.initials }}
              </div>
              <img *ngIf="item.customer.avatar" [src]="item.customer.avatar" class="avatar-img" alt="Customer avatar">
              <span class="customer-name">{{ item.customer.name }}</span>
            </div>
          </td>
          <td>
            <span class="badge status" [ngClass]="getStatusClass()">{{ item.status }}</span>
          </td>
          <td class="actions-cell">
            <div class="menu-container">
              <button class="more-options-btn" (click)="openMoreOptions($event, item)" aria-label="More options">
                <span class="dots">⋮</span>
              </button>
              <div class="dropdown-menu" *ngIf="item.showMenu">
                <div class="menu-item" (click)="handleAction($event, item, 'edit')" role="button" tabindex="0">
                  <span class="menu-icon edit-icon"></span>
                  <span class="menu-text">Edit</span>
                </div>
                <div class="menu-item" (click)="handleAction($event, item, 'delete')" role="button" tabindex="0">
                  <span class="menu-icon delete-icon"></span>
                  <span class="menu-text">Delete</span>
                </div>
              </div>
            </div>
          </td>
        </tr>

        <!-- Empty state if no items -->
        <tr *ngIf="items.length === 0">
          <td colspan="6" class="empty-state">
            <div class="empty-message">
              <span>No draft orders or inquiries found</span>
            </div>
          </td>
        </tr>
      </ng-container>

      <!-- Loading template -->
      <ng-template #loadingTemplate>
        <tr *ngFor="let i of [1,2,3,4,5]">
          <td colspan="6">
            <div class="loading-skeleton"></div>
          </td>
        </tr>
      </ng-template>
      </tbody>
    </table>
  </div>
</div>
